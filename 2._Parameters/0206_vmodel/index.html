
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OpenSWPC User's Guide">
      
      
        <meta name="author" content="Takuto Maeda">
      
      
        <link rel="canonical" href="https://OpenSPWC.github.io/2._Parameters/0206_vmodel/">
      
      
        <link rel="prev" href="../0205_output/">
      
      
        <link rel="next" href="../0207_source/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Velocity Model - OpenSWPC</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/notosansjp.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#velocity-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OpenSWPC" class="md-header__button md-logo" aria-label="OpenSWPC" data-md-component="logo">
      
  <img src="../../fig/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenSWPC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Velocity Model
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ja/2._Parameters/0206_vmodel/" hreflang="ja" class="md-select__link">
              Japanese
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/OpenSWPC/OpenSWPC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OpenSWPC/OpenSWPC
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  OpenSWPC Users' Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../New_Feature/" class="md-tabs__link">
        
  
  
    
  
  Version History &amp; New features

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../1._SetUp/0100_trial/" class="md-tabs__link">
          
  
  
  How to build

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../0201_description/" class="md-tabs__link">
          
  
  
  Parameter settings

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../3._Tools/0301_snapshot/" class="md-tabs__link">
          
  
  
  Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../4._Hints/0401_modelset/" class="md-tabs__link">
          
  
  
  Hints

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../License/" class="md-tabs__link">
        
  
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OpenSWPC" class="md-nav__button md-logo" aria-label="OpenSWPC" data-md-component="logo">
      
  <img src="../../fig/icon.png" alt="logo">

    </a>
    OpenSWPC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OpenSWPC/OpenSWPC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    OpenSWPC/OpenSWPC
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenSWPC Users' Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../New_Feature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Version History &amp; New features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How to build
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How to build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0100_trial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trial of OpenSWPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0101_env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System requirements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0102_tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code directory tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0103_compile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compilation and Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0104_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset Preparation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0105_parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Execution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Parameter settings
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Parameter settings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0201_description/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Notation of the Parameter File
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0202_control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Controlling Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0203_coord/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coordinates and Parallel Computation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0204_visco/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intrinsic Absorption and Viscoelastic Bodies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0205_output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulation Data Output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Velocity Model
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Velocity Model
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#choice-of-velocity-model-type" class="md-nav__link">
    <span class="md-ellipsis">
      Choice of Velocity Model Type
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Choice of Velocity Model Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmodeluni" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='uni'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmodellhm-lgm" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='lhm' &amp; 'lgm'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmodelgrd" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='grd'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmodeluser" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='user'
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on-treatments-of-air-and-seawater-layer" class="md-nav__link">
    <span class="md-ellipsis">
      On Treatments of Air and Seawater Layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-scale-random-inhomogeneity" class="md-nav__link">
    <span class="md-ellipsis">
      Small-Scale Random Inhomogeneity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Small-Scale Random Inhomogeneity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmodeluni_rmed" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='uni_rmed'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmodellhm_rmed-lgm_rmed" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='lhm_rmed' &amp; 'lgm_rmed'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmodelgrd_rmed" class="md-nav__link">
    <span class="md-ellipsis">
      vmodel='grd_rmed'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#truncation-of-velocity-fluctuations" class="md-nav__link">
    <span class="md-ellipsis">
      Truncation of Velocity Fluctuations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#truncation-of-low-velocity-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Truncation of Low-Velocity Layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#earth-flattening-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Earth-flattening transformation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0207_source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Earthquake Source Specification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0208_abc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Absorbing Boundary Conditions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0209_checkpoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checkpointing and Restarting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0210_reciprocity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reciprocity Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../0211_2dcode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Two-Dimensional Codes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0301_snapshot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapshot data handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0302_vmodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Velocity Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0303_parameter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Programs for Supporting Parameter Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0304_rmedia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generation of Random Media
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0305_python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0306_misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miscellaneous Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hints
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Hints
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4._Hints/0401_modelset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    For Parameter Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4._Hints/0402_modification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    For Modifying the Code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../License/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="velocity-model">Velocity Model<a class="headerlink" href="#velocity-model" title="Permanent link">&para;</a></h1>
<h2 id="choice-of-velocity-model-type">Choice of Velocity Model Type<a class="headerlink" href="#choice-of-velocity-model-type" title="Permanent link">&para;</a></h2>
<p>Users can choose a uniform (<code>uni</code>), a layered homogeneous medium
(<code>lhm</code>), or a <code>NetCDF</code> (grd) file input (<code>grd</code>) velocity type. In
addition, a randomly inhomogeneous medium calculated by an external
program can be overlaid onto the model.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>vmodel_type</code></strong></dt>
<dd>
<p>Specify the input velocity model. Choose from one of the following.</p>
<dl>
<dt><strong><code>’uni’</code></strong></dt>
<dd>Homogeneous medium with a free surface. The following additional parameters are required:</dd>
<dt><strong><code>’lhm’</code></strong></dt>
<dd>Layered Homogeneous Medium. A model with a constant physical property value for each depth layer.</dd>
<dt><strong><code>'lgm'</code></strong> (New in Version 25.01)</dt>
<dd>Linear Gradient Model: A model in which seismic wave velocity changes linearly within a layer.</dd>
<dt><strong><code>’grd’</code></strong></dt>
<dd>Velocity model input from <code>NetCDF</code> (GMT grd) files. </dd>
<dt><strong><code>’user’</code></strong></dt>
<dd>Velocity model determined by user subroutine</dd>
</dl>
</dd>
</dl>
</div>
<p>Depending on the structural model chosen, the additional parameters required will differ as described below.        </p>
<h3 id="vmodeluni"><code>vmodel='uni'</code><a class="headerlink" href="#vmodeluni" title="Permanent link">&para;</a></h3>
<p>The following parameters are required:</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>vp0</code></strong></dt>
<dd>P-wave velocity [km/s] in the uniform model.</dd>
<dt><strong><code>vs0</code></strong></dt>
<dd>S-wave velocity [km/s] in the uniform model.</dd>
<dt><strong><code>rho0</code></strong></dt>
<dd>Mass density [g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>] in the uniform model.</dd>
<dt><strong><code>qp0</code></strong></dt>
<dd><span class="arithmatex"><script type="math/tex">Q_P</script></span> of the uniform model.</dd>
<dt><strong><code>qs0</code></strong></dt>
<dd><span class="arithmatex"><script type="math/tex">Q_S</script></span> of the uniform model.</dd>
<dt><strong><code>topo0</code></strong></dt>
<dd>Topography depth in the uniform model. If this value is greater than zero, seawater is filled from <span class="arithmatex"><script type="math/tex">z=0</script></span> to this depth.</dd>
</dl>
</div>
<h3 id="vmodellhm-lgm"><code>vmodel='lhm' &amp; 'lgm'</code><a class="headerlink" href="#vmodellhm-lgm" title="Permanent link">&para;</a></h3>
<p>In <code>lhm</code> (Layered Homogeneous Medium) and <code>lgm</code>, the interface depth and physical properties of each layer are specified in a table.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_lhm</code></strong></dt>
<dd>Medium specification file. Each line specifies the depth of
the top of the layer, density, P-wave velocity, S-wave
velocity, <span class="arithmatex"><script type="math/tex">Q_P</script></span>, and <span class="arithmatex"><script type="math/tex">Q_S</script></span> below that depth. They must be
separated by space(s) (see the following example). Lines
starting with <code>#</code> will be neglected.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># depth  rho(g/cm^3)  vp(km/s)   vs(km/s)     Qp      Qs</span>
<span class="cp"># -------------------------------------------------------</span>
<span class="w">      </span><span class="mi">0</span><span class="w">        </span><span class="mf">2.300</span><span class="w">      </span><span class="mf">5.50</span><span class="w">      </span><span class="mf">3.14</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">      </span><span class="mi">3</span><span class="w">        </span><span class="mf">2.400</span><span class="w">      </span><span class="mf">6.00</span><span class="w">      </span><span class="mf">3.55</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">     </span><span class="mi">18</span><span class="w">        </span><span class="mf">2.800</span><span class="w">      </span><span class="mf">6.70</span><span class="w">      </span><span class="mf">3.83</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">     </span><span class="mi">33</span><span class="w">        </span><span class="mf">3.200</span><span class="w">      </span><span class="mf">7.80</span><span class="w">      </span><span class="mf">4.46</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">    </span><span class="mi">100</span><span class="w">        </span><span class="mf">3.300</span><span class="w">      </span><span class="mf">8.00</span><span class="w">      </span><span class="mf">4.57</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">    </span><span class="mi">225</span><span class="w">        </span><span class="mf">3.400</span><span class="w">      </span><span class="mf">8.40</span><span class="w">      </span><span class="mf">4.80</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">    </span><span class="mi">325</span><span class="w">        </span><span class="mf">3.500</span><span class="w">      </span><span class="mf">8.60</span><span class="w">      </span><span class="mf">4.91</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
<span class="w">    </span><span class="mi">425</span><span class="w">        </span><span class="mf">3.700</span><span class="w">      </span><span class="mf">9.30</span><span class="w">      </span><span class="mf">5.31</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span>
</code></pre></div></td></tr></table></div></dd>
</dl>
</div>
<p>Both <code>lhm</code> and <code>lgm</code> are the same file (in both cases, the parameter name is <code>fn_lhm</code>), but the physical properties created from the same file are different. In the case of <code>lhm</code>, the layers below the first column are filled with uniform physical properties specified in the second to sixth columns. In contrast, in the case of <code>lgm</code>, the physical properties change linearly up to the layer one row below. However, the bottom layer (last row) behaves in the same way as <code>lhm</code>.</p>
<p>In order to understand these behaviors, consider the following simplified model. Although there are actually multiple values such as density, Vp, and Vs, we will explain them using a single velocity value.</p>
<p>In order to understand these behaviors, let us consider the following simplified model. There are actually multiple values such as density, Vp, and Vs, but we will explain them using a single wavespeed.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># depth  velocity</span>
<span class="cp"># ----------------</span>
<span class="w">      </span><span class="mi">0</span><span class="w">        </span><span class="n">V1</span>
<span class="w">     </span><span class="mi">10</span><span class="w">        </span><span class="n">V2</span>
<span class="w">     </span><span class="mi">30</span><span class="w">        </span><span class="n">V3</span>
<span class="w">     </span><span class="mi">30</span><span class="w">        </span><span class="n">V4</span>
<span class="w">     </span><span class="mi">40</span><span class="w">        </span><span class="n">V5</span>
</code></pre></div></td></tr></table></div>
<p>The depth-dependent velocity structure created using this structural model file is as shown in the figure below.</p>
<figure>
<p><img alt="" src="../../fig/lhm_lgm_layer.png" /></p>
<figcaption>
<p>An example of the difference in depth-dependent velocity structure between <code>lhm</code> and <code>lgm</code>, which are created from the same structure specification file. <code>lhm</code> has uniform physical properties within a layer, whereas <code>lgm</code> has linear variation in physical properties within a layer.</p>
</figcaption>
</figure>
<p>In the case of <code>lhm</code>, the layers below the depth of each layer are filled with the physical properties of the line. In the above example, there are two layers at a depth of 30 km, and the physical properties <code>V3</code> and <code>V4</code> are specified for each, but in the case of <code>lhm</code>, the <code>V3</code> layer is ignored because it is 0 in thickness.</p>
<p>In the case of <code>lgm</code>, on the other hand, the physical properties of each layer change linearly with depth up to the value of the next layer. In this case, the different physical properties of the two 30 km-deep layers can also be used to express a discontinuous surface. If the same property value (<code>V1</code>) is applied over a certain range as an following example, it behaves in the same way as <code>lhm</code>: </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">V1</span>
<span class="mi">10</span><span class="w"> </span><span class="n">V1</span>
</code></pre></div></td></tr></table></div>
<p>In other words, <code>lgm</code> can express all the structures that can be expressed by <code>lhm</code>. However, the structure specification files for <code>lhm</code> and <code>lgm</code> are different from each other so that the same structure is expressed by <code>lhm</code> and <code>lgm</code>.</p>
<h3 id="vmodelgrd"><code>vmodel='grd'</code><a class="headerlink" href="#vmodelgrd" title="Permanent link">&para;</a></h3>
<p>The following additional parameters are required for structural input using <code>NetCDF</code> files.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>dir_grd</code></strong></dt>
<dd>Directory of the velocity structure (<code>NetCDF</code>) files.</dd>
<dt><strong><code>fn_grdslt</code></strong></dt>
<dd>List file that specifies the grd files and the associated medium. 
Each grd file specifies the depth of the top surface of the structural boundary. 
The unit of depth is "m".　
Each line contains the grd filename (with a single
or double quotation mark; recommended), density, P-wave
velocity, S-wave velocity, <span class="arithmatex"><script type="math/tex">Q_P</script></span>, <span class="arithmatex"><script type="math/tex">Q_S</script></span>, and the layer
number integers (0-9) separated by spaces (see following
example). Lines starting with <code>#</code> will be neglected. The
layer number is used to specify the source or station depth
fit to the layer depth. The first <code>NetCDF</code> file will be
treated as the ground surface. If the depth of the ground
surface is deeper than zero, the depth range from <span class="arithmatex"><script type="math/tex">z = 0</script></span> to
the surface is assumed to be an ocean layer. The grid above
the free surface is treated as an air column.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># grd filename          rho    vp    vs    QP   QS  sw</span>
<span class="cp"># -------------------------------------------------------</span>
<span class="err">&#39;</span><span class="n">eJIVSM_01_TAB_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">1.70</span><span class="w">  </span><span class="mf">0.35</span><span class="w">   </span><span class="mi">119</span><span class="w">    </span><span class="mi">70</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_02_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.95</span><span class="w">  </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">0.50</span><span class="w">   </span><span class="mi">170</span><span class="w">   </span><span class="mi">100</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_03_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">0.60</span><span class="w">   </span><span class="mi">204</span><span class="w">   </span><span class="mi">120</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_04_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.05</span><span class="w">  </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">0.70</span><span class="w">   </span><span class="mi">238</span><span class="w">   </span><span class="mi">140</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_05_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.07</span><span class="w">  </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">0.80</span><span class="w">   </span><span class="mi">272</span><span class="w">   </span><span class="mi">160</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_06_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">0.90</span><span class="w">   </span><span class="mi">306</span><span class="w">   </span><span class="mi">180</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_07_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.15</span><span class="w">  </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">1.00</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_08_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">1.30</span><span class="w">   </span><span class="mi">442</span><span class="w">   </span><span class="mi">260</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_09_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.25</span><span class="w">  </span><span class="mf">3.00</span><span class="w">  </span><span class="mf">1.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_10_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">1.70</span><span class="w">   </span><span class="mi">578</span><span class="w">   </span><span class="mi">340</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_11_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.35</span><span class="w">  </span><span class="mf">3.50</span><span class="w">  </span><span class="mf">2.00</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_12_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.45</span><span class="w">  </span><span class="mf">4.20</span><span class="w">  </span><span class="mf">2.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_13_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_14_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.65</span><span class="w">  </span><span class="mf">5.50</span><span class="w">  </span><span class="mf">3.20</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_15_UPC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">5.80</span><span class="w">  </span><span class="mf">3.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_16_LWC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.40</span><span class="w">  </span><span class="mf">3.80</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_17_CTM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">7.50</span><span class="w">  </span><span class="mf">4.50</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_18_PH2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_19_PH3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.90</span><span class="w">  </span><span class="mf">6.80</span><span class="w">  </span><span class="mf">4.00</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_20_PHM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">8.00</span><span class="w">  </span><span class="mf">4.70</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_21_PA2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.40</span><span class="w">  </span><span class="mf">2.80</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_22_PA3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.50</span><span class="w">  </span><span class="mf">3.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_23_PAM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.40</span><span class="w">  </span><span class="mf">8.10</span><span class="w">  </span><span class="mf">4.60</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
</code></pre></div></td></tr></table></div></dd>
<dt><strong><code>node_grd</code></strong></dt>
<dd>MPI node to input the <code>NetCDF</code> data. All <code>NetCDF</code> files are
first read by this node, and then, transferred to all nodes
via MPI data communication.</dd>
<dt><strong><code>topo_flatten</code></strong></dt>
<dd>Make topography variatinon flat by offsetting the medium below. </dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Renaming <code>is_flatten</code> to <code>topo_flatten</code></p>
<p>This option used to be <code>is_flatten</code> until Version 5.1, but has been renamed to avoid confusion with the <code>earth_flattening</code> option implemented in Version 5.2.</p>
</div>
</div>
<h3 id="vmodeluser"><code>vmodel='user'</code><a class="headerlink" href="#vmodeluser" title="Permanent link">&para;</a></h3>
<p>Any kind of velocity structure can be used by modifying a user subroutine defined in <code>src/swpc_*/m_vmodel_user.F90</code>. Note that <strong>recompilation of the code
is necessary</strong> if this Fortran file is modified. It is also easy to read in arbitrary parameters from a parameter file or to add parameters. Please refer the
comments in the file for the details. </p>
<h2 id="on-treatments-of-air-and-seawater-layer">On Treatments of Air and Seawater Layer<a class="headerlink" href="#on-treatments-of-air-and-seawater-layer" title="Permanent link">&para;</a></h2>
<p>In <code>OpenSWPC</code>, the air column has a mass density of <span class="arithmatex"><script type="math/tex">\rho=0.001</script></span> [g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>], 
velocities of <span class="arithmatex"><script type="math/tex">V_P = V_S = 0</script></span> [km/s], and intrinsic
attenuation parameters of <span class="arithmatex"><script type="math/tex">Q^P = Q^S = 10^{10}</script></span>. 
The air column is treated as a
vacuum with no seismic wave propagation (with zero velocities). However,
<strong>the mass density in the air column must not be zero to avoid division by zero</strong>. </p>
<p>In the ocean column, <span class="arithmatex"><script type="math/tex">\rho= 1.0</script></span> [g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>], <span class="arithmatex"><script type="math/tex">V_S = 0.0</script></span> [km/s],
and <span class="arithmatex"><script type="math/tex">Q^P = Q^S = 10^6</script></span> are assumed. 
The attenuation of underwater sound waves is known to be very small, so we have introduced a very large <span class="arithmatex"><script type="math/tex">Q</script></span> values that are virtually unattenuated. 
The P-wave velocity is <span class="arithmatex"><script type="math/tex">V_P=1.5</script></span> km/s, but in the version 5.2 and later, the depth-dependent Munk's profile which is defined the equation below can be used by setting <code>munk_profile = .true.</code>. </p>
<div class="arithmatex">
<script type="math/tex; mode=display">\begin{align*}
&V_P(z) = 1.5 \times \left[ 1.0 + 0.00737 \left( z_b - 1 + e^{-zb} \right) \right] \text{[m/s]}\\
&z_b = 2(z-1.3) /1.3
\end{align*}</script>
</div>
<p>where the unit of <span class="arithmatex"><script type="math/tex">z</script></span> is km. This profile contains a minima which corresponds to the SOFAR channel at a depth of 1300 m. </p>
<p>In the free
surface and seafloor, the reduced order of the finite difference is
performed according to Okamoto and Takenaka (2005<sup id="fnref:OT2005"><a class="footnote-ref" href="#fn:OT2005">1</a></sup>) and Maeda and Furumura (2003<sup id="fnref:MF2003"><a class="footnote-ref" href="#fn:MF2003">2</a></sup>). 
These discontinuities are automatically detected as boundaries that change <span class="arithmatex"><script type="math/tex">\mu</script></span> and <span class="arithmatex"><script type="math/tex">\lambda</script></span> from zero to a finite value.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>is_ocean</code></strong></dt>
<dd>Seawater mode. When <code>.true.</code> (default), the surface of the sea (the shallowest surface) is filled with sea water from <span class="arithmatex"><script type="math/tex">z=0</script></span>. When <code>.false.</code>, the surface of the sea is all air, and the sea bed is treated as a free surface.</dd>
<dt><strong><code>munk_profile</code></strong> &nbsp; <strong>(new in version 5.2)</strong></dt>
<dd>If this value is <code>.true.</code>, the Munk's profile with minima is applied in the seawater layer. Otherwise a constant value of 1.5 km/s is used. </dd>
</dl>
</div>
<h2 id="small-scale-random-inhomogeneity">Small-Scale Random Inhomogeneity<a class="headerlink" href="#small-scale-random-inhomogeneity" title="Permanent link">&para;</a></h2>
<p>Users may overlay small-scale velocity inhomogeneities with specified
power-law spectra on the background velocity models of <code>’uni’</code>, <code>’lhm’</code>,
and <code>’grd’</code>. The small-scale velocity inhomogeneity <span class="arithmatex"><script type="math/tex">\xi</script></span> is defined by
external files. From the average velocities <span class="arithmatex"><script type="math/tex">V_{P0}</script></span>, <span class="arithmatex"><script type="math/tex">V_{S0}</script></span>, and
<span class="arithmatex"><script type="math/tex">\rho_0</script></span>, the fluctuated velocities and density are given as</p>
<div class="arithmatex">
<script type="math/tex; mode=display">
\begin{align}
  V_P = V_{P0} \left( 1 + \xi \right) , \, V_S = V_{S0} \left( 1 + \xi \right) , \,
  \rho = \rho_0 \left( 1 + \nu \xi \right)
\end{align}
</script>
</div>
<p>where <span class="arithmatex"><script type="math/tex">\nu=0.8</script></span> is a scaling parameter based on a laboratory experiment (Sato et al., 2012<sup id="fnref:SFM2012"><a class="footnote-ref" href="#fn:SFM2012">3</a></sup>).</p>
<p>The random media files are generated by a separated program. See <a href="../../3._Tools/0304_rmedia/">this section</a> for details. 
The random media are given as two- or three-dimensional <code>NetCDF</code> files.
At each grid location, the velocity fluctuation <span class="arithmatex"><script type="math/tex">\xi(I,J,K)</script></span> is defined.
The code automatically reads the corresponding volume from the file; It
is not necessary to decompose the <code>NetCDF</code> files into parts for parallel
computation. If the computational size (<code>Nx, Ny, Nz</code>) is larger than the
random media file size, the media is used repeatedly by applying a
circular boundary condition. The simulation codes do not care if the
grid sizes of the simulation and the input random media file are
identical.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>vmodel_type</code></strong></dt>
<dd>
<p>Velocity structure model type specification.</p>
<dl>
<dt><strong><code>'uni_rmed'</code></strong></dt>
<dd>Uniform homogeneous structure + random medium</dd>
<dt><strong><code>'lhm_rmed'</code></strong></dt>
<dd>Layered homogeneous medium + random medium</dd>
<dt><strong><code>'lgm_rmed'</code></strong></dt>
<dd>Linear Gradient Model + random medium</dd>
<dt><strong><code>'grd_rmed'</code></strong></dt>
<dd>Structure input using <code>NetCDF</code> files + random medium</dd>
</dl>
</dd>
<dt><strong><code>dir_rmed</code></strong></dt>
<dd>A directory name for storing the random media data files.</dd>
</dl>
</div>
<p>Note that users may use the 3D random media files for 2D calculation. </p>
<h3 id="vmodeluni_rmed"><code>vmodel='uni_rmed'</code><a class="headerlink" href="#vmodeluni_rmed" title="Permanent link">&para;</a></h3>
<p>The following parameter is required in addition to the parameters used
in <code>vmodel=’uni’</code>.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_rmed0</code></strong></dt>
<dd>Name of the random medium file.</dd>
</dl>
</div>
<p>In this model, the average velocity will be fluctuated based on the
input <code>fn_rmed0</code>.</p>
<h3 id="vmodellhm_rmed-lgm_rmed"><code>vmodel='lhm_rmed' &amp; 'lgm_rmed'</code><a class="headerlink" href="#vmodellhm_rmed-lgm_rmed" title="Permanent link">&para;</a></h3>
<p>In this model, the small-scale velocity fluctuation is applied to every
layer defined by <code>vmodel=’lhm’</code>. It is possible to assign different
random velocity models at different layers.</p>
<p>The following parameter is substituted in <code>fn_lhm</code>:</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_lhm_rmed</code></strong></dt>
<dd>List file of the velocity structure.
The list file has a similar format to <code>fn_lhm</code>; it contains the
filenames of the random media files in the rightmost column as in the
following example.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># depth  rho(g/cm^3)  vp(km/s)   vs(km/s)     Qp      Qs     fn_rmed</span>
<span class="cp"># ----------------------------------------------------------------------</span>
<span class="w">     </span><span class="mi">0</span><span class="w">        </span><span class="mf">2.300</span><span class="w">      </span><span class="mf">5.50</span><span class="w">      </span><span class="mf">3.14</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia1</span><span class="p">.</span><span class="n">nc</span>
<span class="w">     </span><span class="mi">3</span><span class="w">        </span><span class="mf">2.400</span><span class="w">      </span><span class="mf">6.00</span><span class="w">      </span><span class="mf">3.55</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia1</span><span class="p">.</span><span class="n">nc</span>
<span class="w">    </span><span class="mi">18</span><span class="w">        </span><span class="mf">2.800</span><span class="w">      </span><span class="mf">6.70</span><span class="w">      </span><span class="mf">3.83</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia2</span><span class="p">.</span><span class="n">nc</span>
<span class="w">    </span><span class="mi">33</span><span class="w">        </span><span class="mf">3.200</span><span class="w">      </span><span class="mf">7.80</span><span class="w">      </span><span class="mf">4.46</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia2</span><span class="p">.</span><span class="n">nc</span>
<span class="w">    </span><span class="mi">100</span><span class="w">       </span><span class="mf">3.300</span><span class="w">      </span><span class="mf">8.00</span><span class="w">      </span><span class="mf">4.57</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span>
<span class="w">    </span><span class="mi">225</span><span class="w">       </span><span class="mf">3.400</span><span class="w">      </span><span class="mf">8.40</span><span class="w">      </span><span class="mf">4.80</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span>
<span class="w">    </span><span class="mi">325</span><span class="w">       </span><span class="mf">3.500</span><span class="w">      </span><span class="mf">8.60</span><span class="w">      </span><span class="mf">4.91</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span>
<span class="w">    </span><span class="mi">425</span><span class="w">       </span><span class="mf">3.700</span><span class="w">      </span><span class="mf">9.30</span><span class="w">      </span><span class="mf">5.31</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span>
</code></pre></div></td></tr></table></div>
In this example, the layers starting from depths of 0 km and 3 km have
fluctuations defined in <code>rmedia1.nc</code>, and the layers from 18 km and 33
km are defined in <code>rmedia2.nc</code>. For the layer deeper than 100 km, a
dummy filename (<code>-</code>) is given. In this case (i.e., there is no file
found), a fluctuation will not be given. The dummy filename is mandatory
in this case.</dd>
</dl>
</div>
<h3 id="vmodelgrd_rmed"><code>vmodel='grd_rmed'</code><a class="headerlink" href="#vmodelgrd_rmed" title="Permanent link">&para;</a></h3>
<p>When overlaying the random fluctuations to the layers defined by the
model of <code>vmodel=’grd’</code>, it is possible to assign different random media
to different layers. The starting depth of the velocity fluctuation can
be either the free surface or depths defined by a layer.</p>
<p>The filename of the velocity fluctuation is given by the following
parameter:</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_grdlst_rmed</code></strong></dt>
<dd>A list file that specifies the velocity layer and the random
fluctuation files for each layer.
The list file has two additional columns at the right: the filename of
the random medium and the reference layer number.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># grd filename          rho    vp    vs   QP   QS  sw  fn_rmed      ref</span>
<span class="cp"># -----------------------------------------------------------------------</span>
<span class="err">&#39;</span><span class="n">eJIVSM_01_TAB_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">1.70</span><span class="w">  </span><span class="mf">0.35</span><span class="w">   </span><span class="mi">119</span><span class="w">    </span><span class="mi">70</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_02_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.95</span><span class="w">  </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">0.50</span><span class="w">   </span><span class="mi">170</span><span class="w">   </span><span class="mi">100</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_03_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">0.60</span><span class="w">   </span><span class="mi">204</span><span class="w">   </span><span class="mi">120</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_04_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.05</span><span class="w">  </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">0.70</span><span class="w">   </span><span class="mi">238</span><span class="w">   </span><span class="mi">140</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_05_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.07</span><span class="w">  </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">0.80</span><span class="w">   </span><span class="mi">272</span><span class="w">   </span><span class="mi">160</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_06_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">0.90</span><span class="w">   </span><span class="mi">306</span><span class="w">   </span><span class="mi">180</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_07_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.15</span><span class="w">  </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">1.00</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_08_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">1.30</span><span class="w">   </span><span class="mi">442</span><span class="w">   </span><span class="mi">260</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_09_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.25</span><span class="w">  </span><span class="mf">3.00</span><span class="w">  </span><span class="mf">1.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_10_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">1.70</span><span class="w">   </span><span class="mi">578</span><span class="w">   </span><span class="mi">340</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_11_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.35</span><span class="w">  </span><span class="mf">3.50</span><span class="w">  </span><span class="mf">2.00</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_12_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.45</span><span class="w">  </span><span class="mf">4.20</span><span class="w">  </span><span class="mf">2.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_13_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_14_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.65</span><span class="w">  </span><span class="mf">5.50</span><span class="w">  </span><span class="mf">3.20</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_15_UPC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">5.80</span><span class="w">  </span><span class="mf">3.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_16_LWC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.40</span><span class="w">  </span><span class="mf">3.80</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_17_CTM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">7.50</span><span class="w">  </span><span class="mf">4.50</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span>
<span class="err">&#39;</span><span class="n">eJIVSM_18_PH2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">18</span>
<span class="err">&#39;</span><span class="n">eJIVSM_19_PH3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.90</span><span class="w">  </span><span class="mf">6.80</span><span class="w">  </span><span class="mf">4.00</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">18</span>
<span class="err">&#39;</span><span class="n">eJIVSM_20_PHM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">8.00</span><span class="w">  </span><span class="mf">4.70</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">18</span>
<span class="err">&#39;</span><span class="n">eJIVSM_21_PA2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.40</span><span class="w">  </span><span class="mf">2.80</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">21</span>
<span class="err">&#39;</span><span class="n">eJIVSM_22_PA3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.50</span><span class="w">  </span><span class="mf">3.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">21</span>
<span class="err">&#39;</span><span class="n">eJIVSM_23_PAM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.40</span><span class="w">  </span><span class="mf">8.10</span><span class="w">  </span><span class="mf">4.60</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">21</span>
</code></pre></div></td></tr></table></div></dd>
</dl>
</div>
<p>The reference layer number defines the reference depth plane of the
random media. If this number is zero, the depth grid number of the
computational model is directly used to assign the random media. This is
exactly the same as the behavior of the <code>uni_rmed</code> or <code>lhm_rmed</code> models.
If the nonzero value of the reference layer number <code>NR</code> is specified,
the depth of the <code>NR</code> layer is treated as the base plane. The depth grid
of the random medium is measured from this depth. Introducing this
reference plane, the inclined random media according to the velocity
discontinuity (such as the plate boundary) can be specified. In the
above example, the 18th and 21st layers are treated as the references of
18--20th and 21--23th layers, respectively.</p>
<h3 id="truncation-of-velocity-fluctuations">Truncation of Velocity Fluctuations<a class="headerlink" href="#truncation-of-velocity-fluctuations" title="Permanent link">&para;</a></h3>
<p>If the magnitude of the velocity fluctuation becomes too large, there
can be a spot with non-physical velocity, such as negative velocity or a
velocity too large for the Earth medium. The simulation may be unstable
under the following conditions:</p>
<ol>
<li>
<p>The fluctuated velocity <span class="arithmatex"><script type="math/tex">V=(1+\xi)V_0</script></span> exceeds the stability
    condition for cases with <span class="arithmatex"><script type="math/tex">\xi>0</script></span>.</p>
</li>
<li>
<p>The velocity has unrealistic negative values for cases with
    <span class="arithmatex"><script type="math/tex">\xi<-1.0</script></span>.</p>
</li>
<li>
<p>The mass density has negative values for cases with <span class="arithmatex"><script type="math/tex">\xi<-1.25</script></span>.</p>
</li>
</ol>
<p>To avoid such situations, <code>OpenSWPC</code> automatically limits the range of
the fluctuated velocity to <code>vcut</code><span class="arithmatex"><script type="math/tex">\le v \le \times v_\text{max}</script></span>,
where <code>vcut</code> is an input parameter and <span class="arithmatex"><script type="math/tex">v_\text{max}</script></span> is the maximum
possible velocity derived from the stability condition.</p>
<p>In addition, the following parameter controls the minimum density.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>rhomin</code></strong></dt>
<dd>Minimum mass density in g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>. (1.0 g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span> by default.)</dd>
</dl>
</div>
<h2 id="truncation-of-low-velocity-layer">Truncation of Low-Velocity Layer<a class="headerlink" href="#truncation-of-low-velocity-layer" title="Permanent link">&para;</a></h2>
<p>If the existing ground structure model is used as it is, the <span class="arithmatex"><script type="math/tex">S</script></span> wave velocity near the ground surface in particular may become extremely low, and in some cases the wavelength condition may not be satisfied. It is possible to modify the structure model each time, but in OpenSWPC, the low velocity can be truncated automatically using the following parameters.</p>
<div class="admonition infor">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>vcut</code></strong></dt>
<dd>Cut-off velocity. For the <code>’lhm’</code> or <code>’grd’</code> models, a velocity
slower than this value will be overwritten by the <code>vcut</code> value. This
parameter is used to avoid wavelengths that are too short and
violate the wavelength condition (the wavelength is recommended to
be longer than 5-10 grids). This substitution will not be performed
in the oceanic area.</dd>
</dl>
</div>
<p>The behavior of <code>vcut</code> is somewhat complex in order to maintain the Vp/Vs speed ratio. The <code>vcut</code> decision is made for the input file (<code>fn_lhm</code>, <code>fn_grd</code>, etc.).</p>
<h2 id="earth-flattening-transformation">Earth-flattening transformation<a class="headerlink" href="#earth-flattening-transformation" title="Permanent link">&para;</a></h2>
<p>OpenSWPC performs calculations in the Cartesian coordinate system, but when the propagation distance exceeds several hundred kilometers, the spherical effect of the Earth cannot be ignored.</p>
<p>To address this, the depth of the velocity structure input is treated as the depth <span class="arithmatex"><script type="math/tex">z_s</script></span> from the Earth's surface, which is approximated by a sphere, and the Earth-flattening transformation (e.g., Aki and Richards, Box 9.2) is implemented to convert it to an approximately equivalent horizontal stratified structure.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt>** <code>earth_flattening</code>**  (New in Version 5.2)</dt>
<dd>If this option is <code>.true.</code>, OpenSWPC performs the transformation the Cartesian coordinate to pseudo-spherical coordinate by means of the Earth-flattening tranformation </dd>
</dl>
</div>
<p>When this option is specified, the depth <span class="arithmatex"><script type="math/tex">z_s</script></span> on the sphere is converted to the depth <span class="arithmatex"><script type="math/tex">z_f</script></span> in the Cartesian coordinate system as follows.</p>
<div class="arithmatex">
<script type="math/tex; mode=display">
\begin{align}
z_f = R \log \frac{R}{R-z_s} \quad \Leftrightarrow \quad 
z_s = R \left\{1 - \exp \left[ - \frac{z_f}{R} \right] \right\}
\end{align}
</script>
</div>
<p>where <span class="arithmatex"><script type="math/tex">R</script></span> is the radius of the Earth. The wavespeeds and mass density corresponding to the depth is converted as follows.</p>
<div class="arithmatex">
<script type="math/tex; mode=display">
\begin{align}
& \alpha_f = \frac{R}{R-z_s} \alpha_s = \exp\left[\frac{z_f}{R}\right] \alpha_s
\\
& \beta_f = \frac{R}{R-z_s} \beta_s = \exp\left[\frac{z_f}{R}\right] \beta_s
\\
& \rho_f = \left(\frac{R-z_s}{R}\right)^{m+2} \rho_s = \exp\left[-(m+2)\frac{z_f}{R}\right] \rho_s
\end{align}
</script>
</div>
<p>Here, <span class="arithmatex"><script type="math/tex">m</script></span> is an integer, and <span class="arithmatex"><script type="math/tex">m=3</script></span> is used for SH waves, and <span class="arithmatex"><script type="math/tex">m=-2</script></span> is used for <span class="arithmatex"><script type="math/tex">P</script></span>-<span class="arithmatex"><script type="math/tex">SV</script></span> waves and 3D.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:OT2005">
<p>Okamoto, T., and H. Takenaka (2005). Fluid-solid boundary implementation in the velocity-stress finite- difference method, <em>Zisin 2</em>, <em>57</em>, 355–364, doi:10.4294/zisin1948.57.3_355. (in Japanese with English Abstract) <a href="https://doi.org/10.4294/zisin1948.57.3_355">(article link)</a>&#160;<a class="footnote-backref" href="#fnref:OT2005" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:MF2003">
<p>Maeda, T., and T. Furumura (2013), FDM simulation of seismic waves, ocean acoustic waves, and tsunamis based on tsunami-coupled equations of motion, <em>Pure Appl. Geophys.</em>, <em>170</em>(1-2), 109–127, doi:10.1007/s00024-011-0430-z. <a href="https://doi.org/10.1007/s00024-011-0430-z">(article link)</a>&#160;<a class="footnote-backref" href="#fnref:MF2003" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:SFM2012">
<p>Sato, H., M. C. Fehler, and T. Maeda (2012), <em>Seismic Wave Propagation and Scattering in the Heterogeneous Earth: Second Edition</em>, Springer Berlin Heidelberg, Berlin, Heidelberg, doi:10.1007/978-3-642-23029-5.&#160;<a class="footnote-backref" href="#fnref:SFM2012" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy Takuto Maeda. All Rights Reserved
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "toc.integrate", "navigation.sections"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../mathjax-config.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>